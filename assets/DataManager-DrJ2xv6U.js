import{a as N,j as t}from"./vendor-react-sS2eXbVN.js";import{b as q,c as G,e as ae}from"./index-CeSG4dMj.js";import"./vendor-xyflow-DS7HY60D.js";import"./game-data-dkqy868O.js";import"./solvers-BVGGMuln.js";import"./vendor-elk-CE1VHGi0.js";function Y(a){const r=a.trim();if(!r)return{data:null,error:null};let o=r;o.startsWith("[")||(o="["+o+"]"),o=o.replace(/,\s*\]/g,"]").replace(/,\s*\}/g,"}");try{const l=JSON.parse(o);return{data:Array.isArray(l)?l:[l],error:null}}catch(l){return{data:null,error:l.message}}}function Q(a,r){const o=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),l=URL.createObjectURL(o);Object.assign(document.createElement("a"),{href:l,download:r}).click(),URL.revokeObjectURL(l)}const T=a=>a==null||a===""?"none":a;function X(a){return"p_"+a.toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9_-]/g,"")}function Z(a){return"m_"+a.toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,"")}function ie(a,r){const o="r_"+a.replace(/^m_/,"")+"_",l=new Set(r.filter(n=>n.startsWith(o)).map(n=>n.slice(o.length)));let c=1;for(;l.has(String(c).padStart(2,"0"));)c++;return o+String(c).padStart(2,"0")}function W(a){if(a==null)return null;const r=parseFloat(String(a).replace(/x$/i,"").trim());return isNaN(r)?String(a).replace(/x$/i,"").trim():r}function re(a){const r=a.trim().toUpperCase().replace(/\/S$/,""),o=[["TMF",1e12],["GMF",1e9],["MMF",1e6],["KMF",1e3],["MF",1],["T",1e12],["G",1e9],["M",1e6],["K",1e3]];for(const[c,n]of o)if(r.endsWith(c))return parseFloat(r)*n;const l=parseFloat(r);return isNaN(l)?null:l}function H(a){if(a==null)return null;const r=String(a).trim().replace(/\s/g,"");let o=0;for(const l of r.split("+")){let c=null;for(const n of l.split("*")){const m=re(n);if(m===null)return null;c=c===null?m:c*m}if(c===null)return null;o+=c}return Math.round(o)}function J(a){return a&&a.replace(/<sup>(.*?)<\/sup>/gi,"^$1").replace(/<sub>(.*?)<\/sub>/gi,"_$1").replace(/<[^>]+>/g,"").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function oe(a,r){const o={new:[],missing:[],changed:[],same:[]},l=Object.fromEntries(a.map(n=>[n.name.toLowerCase(),n])),c=new Set;return r.forEach(n=>{if(!n.Page)return;c.add(n.Page.toLowerCase());const m=l[n.Page.toLowerCase()];if(!m){o.new.push({name:n.Page,data:n});return}const e=[],p=parseFloat(n.sellValue);!isNaN(p)&&p!==m.price&&e.push({field:"sellValue → price",from:m.price,to:p});const h=W(n.resValue);h!==W(m.rp_multiplier)&&e.push({field:"resValue → rp_multiplier",from:W(m.rp_multiplier),to:h}),e.length?o.changed.push({item:{id:m.id,name:n.Page},existing:m,changes:e}):o.same.push({id:m.id,name:n.Page})}),a.forEach(n=>{c.has(n.name.toLowerCase())||o.missing.push(n)}),o}const le=["Size","Pollution","PowerInput","PowerOutput","TransferRate","Capacity","Category","Subcategory","Variant","Limited"];function ce(a,r){const o={new:[],missing:[],changed:[],same:[]},l=Object.fromEntries(a.map(n=>[n.name.toLowerCase(),n])),c=new Set;return r.forEach(n=>{if(!n.Page)return;c.add(n.Page.toLowerCase());const m=l[n.Page.toLowerCase()],e=le.filter(h=>n[h]!=null).map(h=>({field:h,value:n[h]}));if(!m){o.new.push({name:n.Page,data:n,infoFields:e});return}const p=[];String(n.Tier??null)!==String(m.tier??null)&&p.push({field:"Tier → tier",from:m.tier??null,to:n.Tier??null}),p.length?o.changed.push({item:{id:m.id,name:n.Page},existing:m,changes:p,infoFields:e}):o.same.push({id:m.id,name:n.Page,infoFields:e})}),a.forEach(n=>{c.has(n.name.toLowerCase())||o.missing.push(n)}),o}function A(a,r){const o=Object.fromEntries(a.map(e=>[e.name.toLowerCase(),e])),l=Object.fromEntries(r.map(e=>[e.name.toLowerCase(),e])),c=r.filter(e=>!o[e.name.toLowerCase()]),n=a.filter(e=>!l[e.name.toLowerCase()]),m=r.filter(e=>o[e.name.toLowerCase()]&&Number(e.qty)!==Number(o[e.name.toLowerCase()].qty)).map(e=>({name:e.name,from:o[e.name.toLowerCase()].qty,to:e.qty}));return{added:c,removed:n,qtyChanged:m,hasChanges:!!(c.length||n.length||m.length)}}function de(a,r,o){const l={},c=(n,m,e)=>(l[n]||(l[n]={id:n,page:m,machine:e,time:null,mamyflux:null,c_mode:null,inputs:[],outputs:[]}),l[n]);return a.forEach(n=>{const m=c(n.id,n.Page,n.machine);Object.assign(m,{time:n.time,mamyflux:n.mamyflux,c_mode:n["time mode"]??null})}),r.forEach(n=>c(n.id,n.Page,n.machine).inputs.push({name:J(n.item),qty:n.amount,q_mode:n["amount mode"]??null})),o.forEach(n=>c(n.id,n.Page,n.machine).outputs.push({name:J(n.item),qty:n.amount,q_mode:n["amount mode"]??null})),l}function pe(a,r,o){const l={new:[],missing:[],changed:[],same:[]},c=new Set,n={},m={},e={};a.forEach(i=>{n[i.id.toLowerCase()]=i,m[(i.id.startsWith("r_")?i.id.slice(2):i.id).toLowerCase()]=i;const s=i.machine_id.toLowerCase();(e[s]=e[s]||[]).push(i)});const p=i=>({inputs:(i.inputs||[]).map(s=>({name:o[s.product_id]||s.product_id,qty:s.quantity})),outputs:(i.outputs||[]).map(s=>({name:o[s.product_id]||s.product_id,qty:s.quantity}))}),h=(i,s,u)=>{const x=S=>S.map(C=>C.name.toLowerCase()).sort(),f=(S,C)=>S.length===C.length&&S.every((z,_)=>z===C[_]),E=p(i);return f(x(E.inputs),x(s))&&f(x(E.outputs),x(u))};return Object.values(r).forEach(i=>{const s=(i.id||"").toLowerCase();let u=n[s]||n["r_"+s]||m[s],x=null;if(u){if(!h(u,i.inputs,i.outputs)){const C=(e[u.machine_id.toLowerCase()]||[]).filter(z=>z.id!==u.id).find(z=>h(z,i.inputs,i.outputs));C&&(x={pastedId:i.id,existingId:C.id},u=C)}}else{const z=Object.values(n).filter(_=>(o[_.machine_id.toLowerCase()]||_.machine_id||"").toLowerCase()===(i.machine||"").toLowerCase()).find(_=>h(_,i.inputs,i.outputs));z&&(x={pastedId:i.id,existingId:z.id},u=z)}if(!u){l.new.push({id:i.id,name:i.page||i.id,machine:i.machine,pasted:i});return}c.add(u.id);const f=[];x&&f.push({field:"id mismatch",from:x.existingId,to:x.pastedId}),i.time!=null&&Number(i.time)!==Number(u.cycle_time)&&f.push({field:"time / cycle_time",from:u.cycle_time,to:i.time}),i.mamyflux!=null&&Number(i.mamyflux)!==Number(u.power_consumption)&&f.push({field:"mamyflux / power_consumption",from:u.power_consumption,to:i.mamyflux});const E=A(p(u).inputs,i.inputs),S=A(p(u).outputs,i.outputs);E.hasChanges&&f.push({field:"inputs",diff:E}),S.hasChanges&&f.push({field:"outputs",diff:S}),f.length?l.changed.push({id:i.id,name:i.page||u.name,machine:i.machine,changes:f,pasted:i,existing:u}):l.same.push({id:i.id,name:i.page||u.name,machine:i.machine})}),a.forEach(i=>{c.has(i.id)||l.missing.push({id:i.id,name:i.name,machine:i.machine_id})}),l}function V(a,r,o,l){r.forEach(c=>{const n=l[c.field];n&&(o||a[n]===null||a[n]===void 0)&&(a[n]=c.to)})}function me(a,r,o){const l=Object.fromEntries(a.map(e=>[e.id,e])),c=e=>({id:e.id,name:e.name,type:T(e.type),price:e.price??null,rp_multiplier:e.rp_multiplier??null}),n=[...o].some(e=>e.startsWith("same:")),m=[];return r.same.forEach((e,p)=>{if(!o.has(`same:${e.id||e.name||p}`))return;const h=l[e.id];h&&m.push(c(h))}),r.changed.forEach((e,p)=>{var s,u;const h=o.has(`changed:${((s=e.item)==null?void 0:s.id)||((u=e.item)==null?void 0:u.name)||p}`);if(!h&&!n)return;const i={...e.existing};V(i,e.changes,h,{"sellValue → price":"price","resValue → rp_multiplier":"rp_multiplier"}),m.push(c(i))}),r.missing.forEach((e,p)=>{o.has(`missing:${e.id||e.name||p}`)&&m.push(c(e))}),r.new.forEach((e,p)=>{var h,i;o.has(`new:${e.name||p}`)&&m.push({id:X(e.name),name:e.name,type:"none",price:parseFloat((h=e.data)==null?void 0:h.sellValue)||null,rp_multiplier:W((i=e.data)==null?void 0:i.resValue)})}),m}const ue={Size:"size",TransferRate:"transfer_rate",Capacity:"capacity",Category:"category",Subcategory:"subcategory",Variant:"variant",Limited:"limited"};function D(a,r){return r&&r.forEach(({field:o,value:l})=>{const c=ue[o];if(c)if(c==="capacity")a[c]=H(l);else if(c==="transfer_rate")a[c]=Math.round(H(l)??0);else if(c==="variant")a[c]=l&&String(l).toLowerCase()!=="none"?"m_"+String(l).toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,""):"none";else if(c==="limited"){const n=String(l).toLowerCase();a[c]=n==="yes"||n==="true"||n==="1"}else a[c]=l}),a}function he(a,r,o){const l=Object.fromEntries(a.map(e=>[e.id,e])),c=(e,p)=>D({id:e.id,name:e.name,cost:e.cost??null,size:e.size??null,tier:e.tier??null,transfer_rate:e.transfer_rate??0,capacity:e.capacity??null,category:e.category??null,subcategory:e.subcategory??null,variant:e.variant&&e.variant!=="none"?"m_"+String(e.variant).toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,""):"none",limited:e.limited!=null?!!e.limited:!1,gamemode:e.gamemode??"any"},p),n=[...o].some(e=>e.startsWith("same:")),m=[];return r.same.forEach((e,p)=>{if(!o.has(`same:${e.id||e.name||p}`))return;const h=l[e.id];h&&m.push(c(h,e.infoFields))}),r.changed.forEach((e,p)=>{var s,u;const h=o.has(`changed:${((s=e.item)==null?void 0:s.id)||((u=e.item)==null?void 0:u.name)||p}`);if(!h&&!n)return;const i={...e.existing};V(i,e.changes,h,{"Tier → tier":"tier"}),m.push(c(i,e.infoFields))}),r.missing.forEach((e,p)=>{o.has(`missing:${e.id||e.name||p}`)&&m.push(c(e,null))}),r.new.forEach((e,p)=>{var h;o.has(`new:${e.name||p}`)&&m.push(D({id:Z(e.name),name:e.name,cost:null,size:null,tier:((h=e.data)==null?void 0:h.Tier)??null,transfer_rate:0,capacity:null,category:null,subcategory:null,variant:"none",limited:!1,gamemode:"any"},e.infoFields))}),m}function xe(a,r,o,l,c){const n=Object.fromEntries(a.map(s=>[s.id,s])),m=s=>({id:s.id,name:s.name,machine_id:s.machine_id,cycle_time:s.cycle_time??null,c_mode:T(s.c_mode),power_consumption:s.power_consumption??null,power_type:T(s.power_type),pollution:s.pollution??0,inputs:(s.inputs||[]).map(u=>({product_id:u.product_id,quantity:u.quantity,q_mode:T(u.q_mode)})),outputs:(s.outputs||[]).map(u=>({product_id:u.product_id,quantity:u.quantity,q_mode:T(u.q_mode)}))}),e=s=>s.map(u=>({product_id:l[(u.name||"").toLowerCase()]||X(u.name||""),quantity:Number(u.qty),q_mode:T(u.q_mode)})),p=Object.keys(n),h=[...o].some(s=>s.startsWith("same:")),i=[];return r.same.forEach((s,u)=>{if(!o.has(`same:${s.id||u}`))return;const x=n[s.id]||n["r_"+s.id];x&&i.push(m(x))}),r.changed.forEach((s,u)=>{var C,z,_,d,g,y,b,v;const x=o.has(`changed:${s.id||u}`);if(!x&&!h)return;const f={...s.existing};V(f,s.changes,x,{"time / cycle_time":"cycle_time","mamyflux / power_consumption":"power_consumption"});const E=s.changes.find(L=>L.field==="inputs"),S=s.changes.find(L=>L.field==="outputs");x?(E&&(f.inputs=e(s.pasted.inputs||[])),S&&(f.outputs=e(s.pasted.outputs||[])),((C=s.pasted)==null?void 0:C.c_mode)!==void 0&&(f.c_mode=s.pasted.c_mode)):(!((z=f.inputs)!=null&&z.length)&&((d=(_=s.pasted)==null?void 0:_.inputs)!=null&&d.length)&&(f.inputs=e(s.pasted.inputs)),!((g=f.outputs)!=null&&g.length)&&((b=(y=s.pasted)==null?void 0:y.outputs)!=null&&b.length)&&(f.outputs=e(s.pasted.outputs)),(f.c_mode==null||f.c_mode==="none")&&((v=s.pasted)==null?void 0:v.c_mode)!=null&&(f.c_mode=s.pasted.c_mode)),i.push(m(f))}),r.missing.forEach((s,u)=>{if(!o.has(`missing:${s.id||u}`))return;const x=n[s.id];x&&i.push(m(x))}),r.new.forEach((s,u)=>{if(!o.has(`new:${s.id||u}`))return;const x=s.pasted,f=c[(x.machine||"").toLowerCase()]||Z(x.machine||""),E=ie(f,p);p.push(E),i.push({id:E,name:x.page||x.id,machine_id:f,cycle_time:x.time??null,c_mode:T(x.c_mode),power_consumption:x.mamyflux??null,power_type:"none",pollution:0,inputs:e(x.inputs||[]),outputs:e(x.outputs||[])})}),i}const F={new:{label:"New",color:"#22c55e"},missing:{label:"Missing",color:"#f59e0b"},changed:{label:"Changed",color:"#3b82f6"},same:{label:"Unchanged",color:"var(--text-muted)"}},$=({children:a,color:r,bg:o,border:l})=>t.jsx("span",{style:{fontSize:"11px",padding:"1px 5px",background:o,border:`1px solid ${l}`,color:r,borderRadius:"var(--radius-sm)"},children:a}),B=({field:a,from:r,to:o})=>t.jsxs("span",{style:{fontSize:"11px",padding:"2px 6px",background:"var(--bg-secondary)",borderRadius:"var(--radius-sm)",color:"var(--text-secondary)"},children:[a,": ",t.jsx("span",{style:{color:"#f87171"},children:String(r)})," → ",t.jsx("span",{style:{color:"#4ade80"},children:String(o)})]}),I=({children:a,accent:r})=>t.jsx("div",{style:{padding:"6px 10px",background:"var(--bg-main)",borderRadius:"var(--radius-sm)",fontSize:"13px",borderLeft:`3px solid ${r||"transparent"}`},children:a}),ee=({results:a})=>t.jsx("div",{style:{display:"flex",gap:"8px",marginBottom:"10px",flexWrap:"wrap"},children:Object.entries(F).map(([r,{label:o,color:l}])=>t.jsxs("div",{style:{padding:"4px 12px",background:"var(--bg-secondary)",borderRadius:"var(--radius-sm)",fontSize:"12px",border:`1px solid ${l}44`},children:[t.jsxs("span",{style:{color:l},children:[o,":"]})," ",t.jsx("strong",{style:{color:"var(--text-primary)"},children:a[r].length})]},r))}),te=({filters:a,onToggle:r,search:o,onSearch:l})=>t.jsxs("div",{style:{display:"flex",gap:"6px",marginBottom:"10px",alignItems:"center",flexWrap:"wrap"},children:[Object.entries(F).map(([c,{label:n,color:m}])=>t.jsx("button",{onClick:()=>r(c),className:"btn btn-secondary",style:{padding:"3px 10px",fontSize:"12px",minWidth:"auto",width:"auto",opacity:a.includes(c)?1:.35,color:a.includes(c)?m:void 0,borderColor:a.includes(c)?m:void 0},children:n},c)),t.jsx("input",{type:"text",placeholder:"Search...",value:o,onChange:c=>l(c.target.value),className:"input",style:{flex:1,minWidth:"100px",padding:"4px 8px",fontSize:"12px"}})]}),M=({status:a,items:r,renderItem:o,selectedKeys:l,onToggleKey:c,getKey:n})=>{const[m,e]=N.useState(!0),{label:p,color:h}=F[a];if(!r.length)return null;const i=r.map(n),s=i.every(x=>l.has(x)),u=!s&&i.some(x=>l.has(x));return t.jsxs("div",{style:{marginBottom:"10px",border:"1px solid var(--border-divider)",borderRadius:"var(--radius-sm)",overflow:"hidden"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"7px 12px",background:"var(--bg-secondary)",cursor:"pointer"},onClick:()=>e(x=>!x),children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx("input",{type:"checkbox",checked:s,ref:x=>{x&&(x.indeterminate=u)},onChange:x=>{x.stopPropagation(),i.forEach(f=>c(f,!s))},onClick:x=>x.stopPropagation(),style:{cursor:"pointer",flexShrink:0}}),t.jsx("span",{style:{color:h,fontWeight:600,fontSize:"13px"},children:p})]}),t.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[t.jsx("span",{style:{background:h,color:"#fff",borderRadius:"999px",padding:"1px 8px",fontSize:"11px",fontWeight:700},children:r.length}),t.jsx("span",{style:{color:"var(--text-muted)",fontSize:"11px"},children:m?"▲":"▼"})]})]}),m&&t.jsx("div",{style:{padding:"8px",display:"flex",flexDirection:"column",gap:"4px"},children:r.map((x,f)=>t.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"8px"},children:[t.jsx("input",{type:"checkbox",checked:l.has(i[f]),onChange:()=>c(i[f]),style:{marginTop:"8px",flexShrink:0,cursor:"pointer"}}),t.jsx("div",{style:{flex:1,minWidth:0},children:o(x,f)})]},i[f]))})]})},ne=({children:a})=>t.jsx("div",{style:{fontSize:"11px",color:"var(--text-muted)",background:"var(--bg-secondary)",borderRadius:"var(--radius-sm)",padding:"8px 12px",marginBottom:"10px",lineHeight:"1.6",border:"1px solid var(--border-divider)"},children:a}),se=()=>{const[a,r]=N.useState(new Set);return[a,r,(l,c)=>r(n=>{const m=new Set(n);return(c!==void 0?c:!m.has(l))?m.add(l):m.delete(l),m})]},K=({typeName:a,existing:r,compareFn:o,renderNew:l,renderMissing:c,renderChanged:n,renderSame:m,exportBuilder:e,hint:p})=>{const[h,i]=N.useState(""),[s,u]=N.useState(null),[x,f]=N.useState(null),[E,S]=N.useState(["new","missing","changed"]),[C,z]=N.useState(""),[_,,d]=se(),g=(j,w)=>{const P=w.item||w;return`${j}:${P.id||P.name}`},y=()=>{const{data:j,error:w}=Y(h);if(w){f(w),u(null);return}if(!(j!=null&&j.length)){f("No valid JSON array found");return}f(null),u(o(r,j))},b=N.useMemo(()=>{if(!s)return null;const j=C.toLowerCase(),w=P=>P.filter(O=>{const k=O.item||O;return!j||(k.name||k.id||"").toLowerCase().includes(j)});return{new:w(s.new),missing:w(s.missing),changed:w(s.changed),same:w(s.same)}},[s,C]),v=j=>S(w=>w.includes(j)?w.filter(P=>P!==j):[...w,j]),L=()=>{s&&Q(e(r,s,_),`${a.toLowerCase()}_export.json`)};return t.jsxs("div",{children:[p&&t.jsx(ne,{children:p}),t.jsx("textarea",{value:h,onChange:j=>i(j.target.value),className:"input",placeholder:`Paste ${a} JSON array...
[
  { "Page": "...", ... },
  ...
]`,style:{width:"100%",minHeight:"110px",fontFamily:"monospace",fontSize:"12px",resize:"vertical",marginBottom:"8px",boxSizing:"border-box"}}),x&&t.jsxs("div",{style:{color:"#f87171",fontSize:"12px",marginBottom:"8px"},children:["⚠ ",x]}),t.jsxs("button",{onClick:y,className:"btn btn-primary",style:{width:"100%",marginBottom:"14px"},disabled:!h.trim(),children:["Compare ",a]}),b&&t.jsxs(t.Fragment,{children:[t.jsx(ee,{results:b}),t.jsx(te,{filters:E,onToggle:v,search:C,onSearch:z}),["new","missing","changed","same"].filter(j=>E.includes(j)).map(j=>t.jsx(M,{status:j,items:b[j],renderItem:j==="changed"?n:j==="new"?l:j==="missing"?c:m,selectedKeys:_,onToggleKey:d,getKey:(w,P)=>g(j,w)||`${j}:${P}`},j)),_.size>0&&t.jsxs("button",{onClick:L,className:"btn btn-primary",style:{width:"100%",marginTop:"10px",background:"#16a34a",borderColor:"#16a34a"},children:["↓ Export ",_.size," selected item",_.size!==1?"s":""," as JSON"]})]})]})},fe=({existing:a})=>{const[r,o]=N.useState({info:"",inputs:"",outputs:""}),[l,c]=N.useState(null),[n,m]=N.useState({}),[e,p]=N.useState(["new","missing","changed"]),[h,i]=N.useState(""),[s,,u]=se(),x=(d,g,y)=>`${d}:${g.id||y}`,f=()=>{const d=Object.fromEntries(Object.entries(r).map(([v,L])=>[v,Y(L)])),g=Object.fromEntries(Object.entries(d).filter(([,v])=>v.error).map(([v,L])=>[v,L.error]));if(m(g),Object.keys(g).length){c(null);return}if(!d.info.data&&!d.inputs.data&&!d.outputs.data){m({general:"Nothing pasted"});return}const y=de(d.info.data||[],d.inputs.data||[],d.outputs.data||[]),b=Object.fromEntries(q().map(v=>[v.id,v.name]));c(pe(a,y,b))},E=()=>{if(!l)return;const d=Object.fromEntries(q().map(y=>[y.name.toLowerCase(),y.id])),g=Object.fromEntries(G().map(y=>[y.name.toLowerCase(),y.id]));Q(xe(a,l,s,d,g),"recipes_export.json")},S=N.useMemo(()=>{if(!l)return null;const d=h.toLowerCase(),g=y=>y.filter(b=>!d||(b.name||b.id||"").toLowerCase().includes(d)||(b.machine||"").toLowerCase().includes(d));return{new:g(l.new),missing:g(l.missing),changed:g(l.changed),same:g(l.same)}},[l,h]),C=d=>p(g=>g.includes(d)?g.filter(y=>y!==d):[...g,d]),z={width:"100%",minHeight:"100px",fontFamily:"monospace",fontSize:"12px",resize:"vertical",boxSizing:"border-box"},_=(d,g)=>t.jsxs(I,{accent:"#3b82f6",children:[t.jsxs("div",{style:{fontWeight:500,color:"var(--text-primary)",marginBottom:"4px"},children:[d.name," ",t.jsxs("span",{style:{color:"var(--text-muted)",fontSize:"11px"},children:["(",d.id,")"]})]}),t.jsx("div",{style:{display:"flex",gap:"6px",flexWrap:"wrap",marginBottom:"4px"},children:d.changes.filter(y=>y.field!=="inputs"&&y.field!=="outputs").map(y=>t.jsx(B,{...y},y.field))}),d.changes.filter(y=>y.field==="inputs"||y.field==="outputs").map(y=>t.jsxs("div",{style:{marginTop:"4px"},children:[t.jsxs("div",{style:{fontSize:"11px",color:"var(--text-muted)",marginBottom:"2px",textTransform:"uppercase",letterSpacing:"0.04em"},children:[y.field," changes"]}),t.jsxs("div",{style:{display:"flex",gap:"4px",flexWrap:"wrap"},children:[y.diff.added.map((b,v)=>t.jsxs($,{color:"#4ade80",bg:"#052e16",border:"#166534",children:["+ ",b.name," ×",b.qty]},v)),y.diff.removed.map((b,v)=>t.jsxs($,{color:"#f87171",bg:"#2d0a0a",border:"#7c2d12",children:["− ",b.name," ×",b.qty]},v)),y.diff.qtyChanged.map((b,v)=>t.jsxs($,{color:"#93c5fd",bg:"var(--bg-secondary)",border:"#1e40af",children:[b.name,": ×",b.from," → ×",b.to]},v))]})]},y.field))]},d.id||g);return t.jsxs("div",{children:[t.jsxs(ne,{children:["Paste data from each wiki table into the fields below, then click ",t.jsx("strong",{children:"Compare Recipes"}),".",t.jsx("br",{}),t.jsx("strong",{children:"Checked"})," items export with pasted values applied. ",t.jsx("strong",{children:"Unchecked"})," Changed items (when any Unchanged are selected) export using existing values, filling only empty fields from pasted data."]}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"10px",marginBottom:"8px"},children:[{key:"info",label:"Recipe Info",hint:"Page, id, machine, time, mamyflux"},{key:"inputs",label:"Recipe Inputs",hint:"id, item, amount"},{key:"outputs",label:"Recipe Outputs",hint:"id, item, amount"}].map(({key:d,label:g,hint:y})=>t.jsxs("div",{children:[t.jsxs("div",{style:{fontSize:"12px",color:"var(--text-muted)",marginBottom:"4px"},children:[g," ",t.jsxs("span",{style:{opacity:.6},children:["(",y,")"]})]}),t.jsx("textarea",{value:r[d],onChange:b=>o(v=>({...v,[d]:b.target.value})),className:"input",style:z}),n[d]&&t.jsxs("div",{style:{color:"#f87171",fontSize:"12px",marginTop:"4px"},children:["⚠ ",n[d]]})]},d))}),n.general&&t.jsxs("div",{style:{color:"#f87171",fontSize:"12px",marginBottom:"8px"},children:["⚠ ",n.general]}),t.jsx("button",{onClick:f,className:"btn btn-primary",style:{width:"100%",marginBottom:"14px"},disabled:!r.info.trim()&&!r.inputs.trim()&&!r.outputs.trim(),children:"Compare Recipes"}),S&&t.jsxs(t.Fragment,{children:[t.jsx(ee,{results:S}),t.jsx(te,{filters:e,onToggle:C,search:h,onSearch:i}),e.includes("new")&&t.jsx(M,{status:"new",items:S.new,selectedKeys:s,onToggleKey:u,getKey:(d,g)=>x("new",d,g),renderItem:(d,g)=>{var y,b,v,L,j,w,P,O,k,U;return t.jsxs(I,{accent:"#22c55e",children:[t.jsxs("div",{style:{fontWeight:500,color:"var(--text-primary)"},children:[d.name," ",t.jsxs("span",{style:{color:"var(--text-muted)",fontSize:"11px"},children:["(",d.id,")"]})]}),t.jsxs("div",{style:{fontSize:"11px",color:"var(--text-secondary)",marginTop:"2px"},children:["machine: ",d.machine,((y=d.pasted)==null?void 0:y.time)!=null?` · time: ${d.pasted.time}s`:"",((b=d.pasted)==null?void 0:b.mamyflux)!=null?` · mamyflux: ${d.pasted.mamyflux}`:""]}),(((L=(v=d.pasted)==null?void 0:v.inputs)==null?void 0:L.length)>0||((w=(j=d.pasted)==null?void 0:j.outputs)==null?void 0:w.length)>0)&&t.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"4px",flexWrap:"wrap"},children:[((O=(P=d.pasted)==null?void 0:P.inputs)==null?void 0:O.length)>0&&t.jsxs("div",{style:{fontSize:"11px",color:"var(--text-muted)"},children:["In:  ",d.pasted.inputs.map(R=>`${R.name} ×${R.qty}`).join(", ")]}),((U=(k=d.pasted)==null?void 0:k.outputs)==null?void 0:U.length)>0&&t.jsxs("div",{style:{fontSize:"11px",color:"var(--text-muted)"},children:["Out: ",d.pasted.outputs.map(R=>`${R.name} ×${R.qty}`).join(", ")]})]})]},d.id||g)}}),e.includes("missing")&&t.jsx(M,{status:"missing",items:S.missing,selectedKeys:s,onToggleKey:u,getKey:(d,g)=>x("missing",d,g),renderItem:(d,g)=>t.jsxs(I,{accent:"#f59e0b",children:[t.jsxs("div",{style:{fontWeight:500,color:"var(--text-primary)"},children:[d.name," ",t.jsxs("span",{style:{color:"var(--text-muted)",fontSize:"11px"},children:["(",d.id,")"]})]}),t.jsxs("div",{style:{fontSize:"11px",color:"var(--text-secondary)",marginTop:"2px"},children:["machine: ",d.machine]})]},d.id||g)}),e.includes("changed")&&t.jsx(M,{status:"changed",items:S.changed,selectedKeys:s,onToggleKey:u,getKey:(d,g)=>x("changed",d,g),renderItem:_}),e.includes("same")&&t.jsx(M,{status:"same",items:S.same,selectedKeys:s,onToggleKey:u,getKey:(d,g)=>x("same",d,g),renderItem:(d,g)=>t.jsxs(I,{children:[t.jsx("span",{style:{color:"var(--text-primary)",fontWeight:500},children:d.name}),t.jsxs("span",{style:{color:"var(--text-muted)",fontSize:"11px",marginLeft:"6px"},children:["(",d.id,") · ",d.machine]})]},d.id||g)}),s.size>0&&t.jsxs("button",{onClick:E,className:"btn btn-primary",style:{width:"100%",marginTop:"10px",background:"#16a34a",borderColor:"#16a34a"},children:["↓ Export ",s.size," selected item",s.size!==1?"s":""," as JSON"]})]})]})},ge='Paste a JSON array from the wiki products table. Matched by name using the "Page" field. Checked items export with pasted values; unchecked Changed items (when any Unchanged are selected) keep existing values and only fill empty fields.',ye='Paste a JSON array from the wiki machines table. Matched by name using the "Page" field. Info fields (Size, Capacity, etc.) are applied on top of existing data during export.',_e=({onClose:a})=>{const[r,o]=N.useState("products"),l=q(),c=G(),n=ae(),m=[{key:"products",label:"Products",count:l.length},{key:"machines",label:"Machines",count:c.length},{key:"recipes",label:"Recipes",count:n.length}];return t.jsx("div",{className:"modal-overlay",onClick:a,children:t.jsxs("div",{className:"modal",onClick:e=>e.stopPropagation(),style:{width:"1600px",maxWidth:"98vw",maxHeight:"92vh"},children:[t.jsx("h2",{className:"modal-title",children:"Data Comparator"}),t.jsx("div",{style:{display:"flex",gap:"10px",marginBottom:"15px",borderBottom:"2px solid var(--border-divider)"},children:m.map(({key:e,label:p,count:h})=>t.jsxs("button",{onClick:()=>o(e),className:`btn ${r===e?"btn-primary":"btn-secondary"}`,style:{flex:1,borderRadius:"var(--radius-sm) var(--radius-sm) 0 0"},children:[p," ",t.jsxs("span",{style:{opacity:.6,fontSize:"11px"},children:["(",h,")"]})]},e))}),t.jsxs("div",{className:"modal-content",style:{maxHeight:"calc(92vh - 180px)",overflowY:"auto"},children:[r==="products"&&t.jsx(K,{typeName:"Products",existing:l,compareFn:oe,exportBuilder:me,hint:ge,renderNew:({name:e,data:p},h)=>t.jsxs(I,{accent:"#22c55e",children:[t.jsx("div",{style:{fontWeight:500,color:"var(--text-primary)"},children:e}),t.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap",marginTop:"3px"},children:[(p==null?void 0:p.sellValue)!==void 0&&t.jsxs("span",{style:{fontSize:"11px",color:"var(--text-secondary)"},children:["sellValue: ",p.sellValue]}),(p==null?void 0:p.resValue)!==void 0&&t.jsxs("span",{style:{fontSize:"11px",color:"var(--text-secondary)"},children:["resValue: ",p.resValue]})]})]},e||h),renderMissing:(e,p)=>t.jsxs(I,{accent:"#f59e0b",children:[t.jsxs("div",{style:{fontWeight:500,color:"var(--text-primary)"},children:[e.name," ",t.jsxs("span",{style:{color:"var(--text-muted)",fontSize:"11px"},children:["(",e.id,")"]})]}),t.jsxs("div",{style:{display:"flex",gap:"8px",marginTop:"3px"},children:[t.jsxs("span",{style:{fontSize:"11px",color:"var(--text-secondary)"},children:["price: ",e.price]}),t.jsxs("span",{style:{fontSize:"11px",color:"var(--text-secondary)"},children:["rp: ",e.rp_multiplier]})]})]},e.id||p),renderChanged:({item:e,existing:p,changes:h},i)=>t.jsxs(I,{accent:"#3b82f6",children:[t.jsxs("div",{style:{fontWeight:500,color:"var(--text-primary)",marginBottom:"4px"},children:[e.name||p.name," ",t.jsxs("span",{style:{color:"var(--text-muted)",fontSize:"11px"},children:["(",e.id,")"]})]}),t.jsx("div",{style:{display:"flex",gap:"6px",flexWrap:"wrap"},children:h.map(s=>t.jsx(B,{...s},s.field))})]},e.id||i),renderSame:({id:e,name:p},h)=>t.jsxs(I,{children:[t.jsx("span",{style:{color:"var(--text-primary)",fontWeight:500},children:p}),t.jsxs("span",{style:{color:"var(--text-muted)",fontSize:"11px",marginLeft:"6px"},children:["(",e,")"]})]},e||h)}),r==="machines"&&t.jsx(K,{typeName:"Machines",existing:c,compareFn:ce,exportBuilder:he,hint:ye,renderNew:({name:e,data:p,infoFields:h},i)=>t.jsxs(I,{accent:"#22c55e",children:[t.jsx("div",{style:{fontWeight:500,color:"var(--text-primary)"},children:e}),t.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap",marginTop:"3px"},children:[(p==null?void 0:p.Tier)!==void 0&&t.jsxs("span",{style:{fontSize:"11px",color:"var(--text-secondary)"},children:["Tier: ",p.Tier]}),h==null?void 0:h.map(s=>t.jsxs("span",{style:{fontSize:"11px",color:"var(--text-secondary)"},children:[s.field,": ",String(s.value)]},s.field))]})]},e||i),renderMissing:(e,p)=>t.jsxs(I,{accent:"#f59e0b",children:[t.jsxs("div",{style:{fontWeight:500,color:"var(--text-primary)"},children:[e.name," ",t.jsxs("span",{style:{color:"var(--text-muted)",fontSize:"11px"},children:["(",e.id,")"]})]}),t.jsxs("span",{style:{fontSize:"11px",color:"var(--text-secondary)"},children:["tier: ",e.tier]})]},e.id||p),renderChanged:({item:e,existing:p,changes:h,infoFields:i},s)=>t.jsxs(I,{accent:"#3b82f6",children:[t.jsxs("div",{style:{fontWeight:500,color:"var(--text-primary)",marginBottom:"4px"},children:[e.name||p.name," ",t.jsxs("span",{style:{color:"var(--text-muted)",fontSize:"11px"},children:["(",e.id,")"]})]}),t.jsxs("div",{style:{display:"flex",gap:"6px",flexWrap:"wrap"},children:[h.map(u=>t.jsx(B,{...u},u.field)),i==null?void 0:i.map(u=>t.jsxs("span",{style:{fontSize:"11px",padding:"2px 6px",background:"var(--bg-secondary)",borderRadius:"var(--radius-sm)",color:"var(--text-muted)"},children:[u.field,": ",String(u.value)]},u.field))]})]},e.id||s),renderSame:({id:e,name:p,infoFields:h},i)=>t.jsxs(I,{children:[t.jsx("span",{style:{color:"var(--text-primary)",fontWeight:500},children:p}),t.jsxs("span",{style:{color:"var(--text-muted)",fontSize:"11px",marginLeft:"6px"},children:["(",e,")"]}),(h==null?void 0:h.length)>0&&t.jsx("div",{style:{display:"flex",gap:"6px",flexWrap:"wrap",marginTop:"3px"},children:h.map(s=>t.jsxs("span",{style:{fontSize:"11px",color:"var(--text-muted)"},children:[s.field,": ",String(s.value)]},s.field))})]},e||i)}),r==="recipes"&&t.jsx(fe,{existing:n})]}),t.jsx("button",{onClick:a,className:"btn btn-secondary",style:{marginTop:"15px",width:"100%"},children:"Close"})]})})};export{_e as default};
